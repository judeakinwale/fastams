"use strict";(self.webpackChunkamsweb=self.webpackChunkamsweb||[]).push([[315],{6751:function(t,e,n){n.d(e,{b:function(){return a}});var r={baseURL:"https://impactlife.azurewebsites.net/api/v1"},a=n(1243).Z.create(r)},8613:function(t,e,n){n.d(e,{b:function(){return c}});var r=n(5043),a=n(3233),i=n(184);function c(t){var e=t.formData,n=t.handleChange,c=t.validationHandler,o=t.errors;return(0,i.jsx)(a.n,{title:"Enter details",children:(0,i.jsx)(r.II,{name:"email",label:"Email Address",value:e.email,onChange:n,type:"email",validationHandler:c,error:o.email,required:!0,size:"large"})})}},8319:function(t,e,n){n.d(e,{G:function(){return h},r:function(){return g}});var r=n(4165),a=n(5861),i=n(6403),c=n(3418),o=n(7689),u=n(5985),s=n(6751),l=n(6414),f=n(347),d=n(749);function m(){return(m=(0,a.Z)((0,r.Z)().mark((function t(e){var n;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,s.b)({url:"/attendance/sign-in?email=".concat(e.email,"&long=").concat(e.long,"&lat=").concat(e.lat),method:"POST",data:{file:e.file},headers:{"Content-Type":"multipart/form-data"}});case 2:return n=t.sent,t.abrupt("return",null===n||void 0===n?void 0:n.data);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function p(){return(p=(0,a.Z)((0,r.Z)().mark((function t(e){var n;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,s.b)({url:"/attendance/sign-out?email=".concat(e.email,"&long=").concat(e.long,"&lat=").concat(e.lat),method:"PATCH",data:{file:e.file},headers:{"Content-Type":"multipart/form-data"}});case 2:return n=t.sent,t.abrupt("return",null===n||void 0===n?void 0:n.data);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function h(){var t=(0,i.NL)(),e=(0,o.s0)(),n=(0,c.D)({mutationFn:function(t){return function(t){return m.apply(this,arguments)}(t)},onSuccess:function(n){u.Am.success("Clock in successfull",d.HK),t.invalidateQueries([l.a.clockIn]),setTimeout((function(){e(f.Ot.HOME)}),3e3)},onError:function(t){(0,d.sD)(t,d.HK)}});return{mutate:n.mutate,isError:n.isError,error:n.error,isSuccess:n.isSuccess,reset:n.reset}}function g(){var t=(0,i.NL)(),e=(0,o.s0)(),n=(0,c.D)({mutationFn:function(t){return function(t){return p.apply(this,arguments)}(t)},onSuccess:function(n){u.Am.success("Clock Out successfull",d.HK),t.invalidateQueries([l.a.clockIn]),setTimeout((function(){e(f.Ot.HOME)}),3e3)},onError:function(t){(0,d.sD)(t,d.HK)}});return{mutate:n.mutate,isError:n.isError,error:n.error,isSuccess:n.isSuccess,reset:n.reset}}},6315:function(t,e,n){n.r(e);var r=n(4942),a=n(1413),i=n(9439),c=n(2791),o=n(5043),u=n(3722),s=n(8319),l=n(749),f=n(6800),d=n(8613),m=n(5317),p=n(184);e.default=function(){var t=(0,c.useState)({}),e=(0,i.Z)(t,2),n=e[0],h=e[1],g=(0,c.useState)(null),b=(0,i.Z)(g,2),v=b[0],x=b[1],k=(0,c.useState)({}),Z=(0,i.Z)(k,2),j=Z[0],C=Z[1],y=(0,c.useState)(!1),S=(0,i.Z)(y,2),w=S[0],E=S[1],F=(0,c.useRef)(null),H=(0,s.r)(),T=H.mutate,z=H.isSuccess,D=H.reset,N=(0,u.B)();(0,c.useEffect)((function(){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(t){h((0,a.Z)((0,a.Z)({},n),{},{long:t.coords.longitude.toString(),lat:t.coords.latitude.toString()}))}),(function(){C((0,a.Z)((0,a.Z)({},j),{},{location:"Unable to retrieve your location"}))})):C((0,a.Z)((0,a.Z)({},j),{},{location:"Geolocation is not supported by your browser"}))}),[j,n]);var P=(0,c.useCallback)((function(){var t=F.current.getScreenshot();t?(x(t),h((0,a.Z)((0,a.Z)({},n),{},{file:(0,l.v9)(t,"image")})),E(!1),(0,l.Cq)("Picture captured!")):(0,l.ll)("Please wait for camera to load before clicking on capture!")}),[F,n]),A=(0,f.h)([(0,p.jsx)(d.b,{formData:n,errors:j,validationHandler:function(t,e){C((0,a.Z)((0,a.Z)({},j),{},(0,r.Z)({},t,e)))},handleChange:function(t,e){h((0,a.Z)((0,a.Z)({},n),{},(0,r.Z)({},t,e)))}}),(0,p.jsx)(m.s,{webcamRef:F,isLoading:N,capture:P,cameraActive:w,handleCameraClick:function(t){E(!0)},picture:v,formData:n})]),L=A.steps,O=A.currentStepIndex,I=A.step,M=A.isFirstStep,R=A.isLastStep,K=A.back,B=A.next;return z&&D(),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("h1",{children:"Clock Out"}),(0,p.jsxs)(o.cw,{onSubmit:function(){if(!R)return B();n.file?T(n):(0,l.ll)("No picture found.\n\t\t\t\tPlease click on 'Take Picture' to attach your picture to the form")},children:[(0,p.jsxs)("div",{style:{position:"absolute",top:".5rem",right:".5rem"},children:[O+1," / ",L.length]}),I,(0,p.jsxs)("div",{style:{marginTop:"1rem",display:"flex",flexDirection:"column",gap:".5rem"},children:[(0,p.jsx)(o.zx,{title:R?"Finish":"Next",size:"large",type:"submit",className:N?"btn-disabled":"",loading:1===N,disabled:1===N}),!M&&(0,p.jsx)(o.zx,{title:"back",size:"large",onClick:K,type:"button",className:N?"btn-disabled":"btnRedTxt"})]})]})]})}},3233:function(t,e,n){n.d(e,{n:function(){return a}});var r=n(184);function a(t){var e=t.title,n=t.children;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{style:{textAlign:"left",margin:0,marginBottom:"2rem"},children:e}),(0,r.jsx)(r.Fragment,{children:n})]})}},5317:function(t,e,n){n.d(e,{s:function(){return u}});var r=n(5043),a=n(97),i=n.n(a),c=n(3233),o=n(184);function u(t){var e,n=t.webcamRef,a=t.capture,u=t.cameraActive,s=t.handleCameraClick,l=t.picture,f=t.formData;return u&&(e=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"webcam",children:(0,o.jsx)(i(),{audio:!1,ref:n,screenshotFormat:"image/jpeg"})}),(0,o.jsx)(r.zx,{title:"capture",type:"button",style:{background:"black"},onClick:a})]})),!u&&l&&(e=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"webcam",children:(0,o.jsx)("img",{src:l,alt:f.first_name})}),(0,o.jsx)(r.zx,{style:{background:"black"},title:"retake picture",type:"button",onClick:s})]})),u||l||(e=(0,o.jsx)(r.zx,{style:{background:"#3c7d5c"},title:"take picture",type:"button",onClick:s})),(0,o.jsx)(c.n,{title:"Picture Upload",children:e})}},6800:function(t,e,n){n.d(e,{h:function(){return i}});var r=n(9439),a=n(2791);function i(t){var e=(0,a.useState)(0),n=(0,r.Z)(e,2),i=n[0],c=n[1];return{currentStepIndex:i,step:t[i],steps:t,isFirstStep:0===i,isLastStep:i===t.length-1,goTo:function(t){c(t)},next:function(){c((function(e){return e>=t.length-1?e:e+1}))},back:function(){c((function(t){return t<=0?t:t-1}))}}}},3722:function(t,e,n){n.d(e,{B:function(){return s}});var r=n(9439),a=n(2791),i=n(7413),c=n(3734),o=n(9538),u=n(6403);function s(t,e,n){var s=(0,c.cb)(t,e,n),l=(0,r.Z)(s,2),f=l[0],d=l[1],m=void 0===d?{}:d,p=(0,u.NL)({context:m.context}),h=p.getMutationCache();return(0,i.$)(a.useCallback((function(t){return h.subscribe(o.V.batchCalls(t))}),[h]),(function(){return p.isMutating(f)}),(function(){return p.isMutating(f)}))}}}]);
//# sourceMappingURL=315.4e39053b.chunk.js.map